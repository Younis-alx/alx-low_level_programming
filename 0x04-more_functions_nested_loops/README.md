intermediate functions and nested loops 
